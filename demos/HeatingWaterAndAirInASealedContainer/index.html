<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heating Water and Air in a Sealed Container</title>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script>
        MathJax = {
            chtml: {
                scale: 0.95,
                mathmlSpacing: true, // true for MathML spacing rules, false for TeX rules
                displayAlign: 'left', // default for indentalign when set to 'auto'
            },
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <div class="container">
        <!-- Hamburger Menu -->
        <div class="hamburger-menu">
            <div class="menu-btn">
                <i class="fas fa-bars"></i>
            </div>
            <div class="menu-content">
                <div class="menu-item" data-modal="directions">
                    <i class="fas fa-book"></i>
                    <span>Directions</span>
                </div>
                <div class="menu-item" data-modal="details">
                    <i class="fa-solid fa-paperclip"></i>
                    <span>Details</span>
                </div>
                <div class="menu-item" data-modal="about">
                    <i class="fas fa-info-circle"></i>
                    <span>About</span>
                </div>
            </div>
        </div>
        
        <!-- Sliders section -->
        <div class="sliders">
            <div class="control-group">
                <label for="volumeSlider">initial water volume (L) at 25°C:</label>
                <input type="range" id="volumeSlider" min="0.8" max="0.95" step="0.01" value="0.8">
                <div id="volumeValue">0.80 L</div>
            </div>
            
            <div class="control-group">
                <label for="tempSlider">temperature (°C):</label>
                <input type="range" id="tempSlider" min="25" max="250" step="1" value="25">
                <div id="tempValue">25°C</div>
            </div>
        </div>
        
        <!-- Visualization section -->
        <div class="visualization-container">
            <!-- Container visualization -->
            <div class="container-vis-section">
                <div class="container-wrapper">
                    <div class="pressure-stem" id="stem"></div>
                    <div class="pressure-gauge" id="pressureGauge">1.0</div>
                    <div class="container-vis" id="containerVis">
                        <div class="water" id="water"></div>
                        <div class="air" id="air"></div>
                    </div>
                </div>
            </div>
            
            <!-- Plotly chart -->
            <div class="chart-section">
                <div id="plotly-chart"></div>
            </div>
        </div>
    </div>
    
            <!-- Modal Dialogs -->
        <div id="directions-modal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <div class="modal-header">
                    <h2>Directions</h2>
                </div>
                <div class="modal-body">
                    <p>
                        This simulation models the behavior of a sealed, 1-L autoclave that initially contains mostly water plus a small volume of air, 
                        all at 25 °C and 1.0 bar pressure. Change the initial volume of water with a slider and the temperature resets to 25 °C. As the temperature increases 
                        by moving the slider, liquid water expands and its saturation pressure increases. At the same time, the gas-phase volume decreases, 
                        so gas-phase \(O_2\) and \(N_2\) partial pressures increase (ideal gas law). The amounts of \(O_2\) and \(N_2\) dissolved in the 
                        water increase with pressure, but decrease with temperature. The amounts dissolved are shown in the bar chart (green = gas phase, 
                        purple = dissolved). Even at moderate temperatures, the pressure inside the sealed container can be quite high. 
                    </p>
                </div>
            </div>
        </div>
        
        <div id="details-modal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <div class="modal-header">
                    <h2>Details</h2>
                </div>
                <div class="modal-body">
                    <p>The final liquid volume \(V_f^L\) of water is given by:</p>
                    $$V_f^L = (A T^3 + B T^2 + C T + D) V_i^L,$$
                    <p>where \(V_i^L\) is the initial liquid volume (L) at 25 °C, \(T\) is temperature (°C), and \(A\), \(B\), \(C\) and \(D\) are constants.</p>
                    <p>The total pressure $P$ in the container is equal to the saturation pressure of water $P_w^{sat}$ plus the partial pressures of oxygen $P_O$ and nitrogen $P_N$:</p>
                    $$P = P_w^{sat} + P_O + P_N.$$
                    <p>The saturation pressure of water is calculated using the Antoine equation:</p>
                    $$P_w^{sat} = 10^{(A_w - \frac{B_w}{T + C_w})},$$
                    <p>where $A_w$, $B_w$ and $C_w$ are Antoine constants.</p>
                    <p>The partial pressures of oxygen and nitrogen are calculated using the ideal gas law:</p>
                    $$P_j = z_j n_j^V R (T + 273) / V^V,$$
                    <p>where $z_j$ is the fraction of oxygen or nitrogen in air where $z_O = 0.21$ and $z_N = 0.79$, $n_j^V$ is the moles of $j$ in the gas phase, $R$ is the ideal gas constant ([L bar]/[mol K]) and $V^V = 1 - V^L$ is the vapor volume (L).</p>
                    <p>The total moles of oxygen $n_O$ and nitrogen $n_N$ in the container are calculated at 25 °C and 1 bar pressure, the moles in the gas phase are calculated using the ideal gas law, and the moles dissolved in water are calculated using Henry's law:</p>
                    $$n_O = \frac{P_O V_i^V}{R (T + 273)} + H_O P_O V_i^L,$$
                    $$n_N = \frac{P_N V_i^V}{R (T + 273)} + H_N P_N V_i^L,$$
                    <p>where $H_O$ and $H_N$ are Henry's law constants (mol/[L bar]):</p>
                    $$H_O = 4.342 \times 10^{-6} e^{1700 / (T + 273)},$$
                    $$H_N = 7.863 \times 10^{-6} e^{1300 / (T + 273)}.$$
                    <p>For all $T$ and $P$, the moles in the gas phase and dissolved must equal the total moles at 25 °C and 1 bar:</p>
                    $$n_O = \frac{P_O V_f^V}{R (T + 273)} + H_O P_O V_f^L,$$
                    $$n_N = \frac{P_N V_f^V}{R (T + 273)} + H_N P_N V_f^L.$$
                </div>
            </div>
        </div>

        <div id="about-modal" class="modal">
            <div class="modal-content">
                <span class="close-btn">&times;</span>
                <div class="modal-header">
                    <h2>About</h2>
                </div>
                <div class="modal-body">
                    <p>
                        This simulation was created in the <a href="https://www.colorado.edu/chbe">Department of Chemical and Biological Engineering</a> at University of 
                        Colorado Boulder for <a href="https://learncheme.com">LearnChemE.com</a> by Drew Smith under the direction of Professor John L. Falconer and 
                        Michelle Medlin. It is a JavaScript/HTML5 implementation of a 
                        <a href="https://demonstrations.wolfram.com/HeatingWaterAndAirInASealedContainer/">Mathematica simulation</a> by Rachael Baumann. It was prepared 
                        with financial support from the National Science Foundation (DUE 2336987 and 2336988) in collaboration with Washington State University. Address 
                        any questions or comments to LearnChemE@gmail.com.   
                    </p>
                </div>
            </div>
        </div>

    <script src="./index.js"></script>
</body>
</html>