{"version":3,"file":"producer-bPLs2NL6.js","sources":["../src/ts/rk45.ts","../src/ts/calcs.ts","../src/ts/Workers/baseWorker.ts","../src/ts/Workers/producer.ts"],"sourcesContent":["// Adaptive RK45 ODE solver for systems of equations\n// --------------------------------------------------\n\nexport type ODEFunc = (t: number, y: number[]) => number[];\n\nexport interface RK45Result {\n  t: number[];\n  y: number[][];\n}\n\nexport interface RK45Options {\n  dt?: number;         // initial step size\n  atol?: number;       // absolute tolerance\n  rtol?: number;       // relative tolerance\n  dtMin?: number;      // minimum step size\n  dtMax?: number;      // maximum step size\n  safety?: number;     // safety factor for adaptive step\n}\n\n/**\n * Integrate dy/dt = f(t, y) from t0 to tEnd using adaptive RK45 (Fehlberg). I anticipate this to be horribly inefficient, but benchmark first optimize later.\n * @param f rhs for dyi/dt = f(t, y)\n * @param y0 inital values for y\n * @param t0 initial time\n * @param tEnd final time to end integration\n * @param opts additional options for solver\n * @returns object containing solution { t, y } where y is an array containing each yi array to be matched with t array\n */\nexport function rk45(\n  f: ODEFunc,\n  y0: number[],\n  t0: number,\n  tEnd: number,\n  opts: RK45Options = {}\n): RK45Result {\n  const {\n    dt = (tEnd - t0) / 1000,\n    atol = 1e-6,\n    rtol = 1e-3,\n    dtMin = 1e-8,\n    dtMax = Math.abs(tEnd - t0) / 5,\n    safety = 0.9,\n  } = opts;\n\n  // In progress: Use Dormand-Prince?\n  // Ai in wikipedia page\n  const c2 = 1 / 4,\n    c3 = 3 / 8,\n    c4 = 12 / 13,\n    c5 = 1,\n    c6 = 1 / 2;\n\n  //   Bij in wikipedia page\n  const a21 = 1 / 4;\n  const a31 = 3 / 32, a32 = 9 / 32;\n  const a41 = 1932 / 2197, a42 = -7200 / 2197, a43 = 7296 / 2197;\n  const a51 = 439 / 216, a52 = -8, a53 = 3680 / 513, a54 = -845 / 4104;\n  const a61 = -8 / 27, a62 = 2, a63 = -3544 / 2565, a64 = 1859 / 4104, a65 = -11 / 40;\n\n  // Ci and Ci hat in wikipedia page\n  const b1 = 16 / 135, b3 = 6656 / 12825, b4 = 28561 / 56430, b5 = -9 / 50, b6 = 2 / 55; // 5th order weights\n  const b1s = 25 / 216, b3s = 1408 / 2565, b4s = 2197 / 4104, b5s = -1 / 5; // 6th order weights\n\n  let t = t0;\n  let y = y0.slice();\n  let h = dt;\n\n  const tVals = [t];\n  const yVals = [y.slice()];\n\n  while (t < tEnd) {\n    // console.log(`[RK45] h = ${h}`)\n    if (h !== h) throw new Error(\"NaN encountered in h\")\n    if (t + h > tEnd) h = tEnd - t;\n\n    // Compute Runge-Kutta stages\n    const k1 = f(t, y.slice());\n    const k2 = f(t + c2 * h, y.map((yi, i) => yi + h * a21 * k1[i]));\n    const k3 = f(t + c3 * h, y.map((yi, i) => yi + h * (a31 * k1[i] + a32 * k2[i])));\n    const k4 = f(t + c4 * h, y.map((yi, i) => yi + h * (a41 * k1[i] + a42 * k2[i] + a43 * k3[i])));\n    const k5 = f(t + c5 * h, y.map((yi, i) => yi + h * (a51 * k1[i] + a52 * k2[i] + a53 * k3[i] + a54 * k4[i])));\n    const k6 = f(t + c6 * h, y.map((yi, i) => yi + h * (a61 * k1[i] + a62 * k2[i] + a63 * k3[i] + a64 * k4[i] + a65 * k5[i])));\n\n    // 4th and 5th order estimates\n    const y4 = y.map((yi, i) => yi + h * (b1s * k1[i] + b3s * k3[i] + b4s * k4[i] + b5s * k5[i]));\n    const y5 = y.map((yi, i) => yi + h * (b1 * k1[i] + b3 * k3[i] + b4 * k4[i] + b5 * k5[i] + b6 * k6[i]));\n\n    // Error estimate and tolerance check\n    const err = Math.sqrt(\n      y.map((_, i) => Math.pow((y5[i] - y4[i]) / (atol + rtol * Math.abs(y[i])), 2)).reduce((a, b) => a + b, 0) / y.length\n    );\n\n    // Accept step if error small enough\n    if (err <= 1.0) {\n      t += h;\n      y = y5;\n      tVals.push(t);\n      yVals.push(y.slice());\n      // console.log(`[RK45] h accepted. New time is ${t}`)\n    }\n\n    // Adapt timestep\n    const scale = safety * Math.pow(1.0 / Math.max(err, 1e-10), 0.25);\n    h = Math.min(dtMax, h * Math.min(4, Math.max(0.1, scale)));\n\n    if (h < dtMin && err > 1.0) {\n      throw new Error(\"Step size underflow â€” integration failed\");\n      break;\n    }\n  }\n\n  return { t: tVals, y: yVals };\n}\n","import type { InitConc, Profile } from \"../types/globals\"\nimport { rk45 } from \"./rk45\"\n\nconst rho_f = 0.868 // Fluid density (g/cc)\nconst g = 981 // Gravitational acceleration (cm/s^2)\nconst mu = 2.15 // Fluid viscosity (mPa.s)\n\nconst rho_r = 1.08 // Red cell density (g/cc)\nconst d_r = 275e-4 // Red cell diameter (cm)\nconst rho_w = 1.00 // White cell density (g/cc)\nconst d_w = 550e-4 // White cell diameter (cm)\n\nexport const TUBE_LENGTH = 305; // mm\nexport const CONC_ARRAY_SIZE = 500; // points in finite element mesh\nexport const PROFILE_LENGTH = 2 * CONC_ARRAY_SIZE + 2; // Size for time, top, cr[500], and cw[500]\n\n/**\n * Convert volume fraction to number concentration (#/[l]^3) for particles of diameter dp units [l].\n * @param phi volume fraction of particle\n * @param dp diameter of particle\n */\nfunction concentration(phi: number, dp: number) {\n    return 6 * phi / (Math.PI * dp**3);\n}\n// Wrappers for more concise syntax\nexport const conc_r = (phi: number) => concentration(phi, d_r);\nexport const conc_w = (phi: number) => concentration(phi, d_w);\n\nconst cr_max = conc_r(1);\nconst cw_max = conc_w(1);\n\n/**\n * Convert concentration (#/cc) to volume fraction for particles of diameter dp (cm).\n * @param conc \n * @param dp \n * @returns \n */\nfunction volume_fraction(conc: number, dp: number) {\n    return conc * Math.PI * dp**3 / 6;\n}\n// Wrappers for more concise syntax\nexport const phi_r = (phi: number) => volume_fraction(phi, d_r);\nexport const phi_w = (phi: number) => volume_fraction(phi, d_w);\n\n/**\n * Calculate the settling velocity of an independant particle using Stokes' law.\n * @param d_p \n * @param rho_p \n * @returns \n */\nfunction settling_coeff_g(d_p: number, rho_p: number) {\n    const vs = (rho_p - rho_f) * g * d_p**2 / (18 * mu) // m/s\n    return vs * 1000 // Convert to mm/s\n}\n\n// Average void envelope thickness\nfunction d_Ep(r_conc: number, w_conc: number) {\n    if (r_conc + w_conc === 0) return 0;\n\n    const d_avg = (r_conc * d_r + w_conc * d_w)  / (r_conc + w_conc); // Average particle diameter\n    const ep = 1.0 - (r_conc + w_conc) * (1 - .4) // Typical packed bed void fraction for spheres\n    if (ep >= 1) return 0;\n\n    const pow = (1 - ep) ** (-1/3)\n    return d_avg * (pow - 1) // Void envelope thickness\n}\n\n// Calculate settling velocities\nconst Sr_g = settling_coeff_g(d_r, rho_r)\nconst Sw_g = settling_coeff_g(d_w, rho_w)\n\n// Calculate the effective settling velocity (mm/s) of a mixture of red and white cells.\nexport function particle_velocities(conc_r: number, conc_w: number) {\n    // Convert to volume fractions\n    const ph_r = volume_fraction(conc_r, d_r)\n    const ph_w = volume_fraction(conc_w, d_w)\n    \n    const conc_f = 1 - ph_r - ph_w // volume fraction of fluid\n    const rho_susp = ph_r * rho_r + ph_w * rho_w + conc_f * rho_f // Suspension density (g/cc)\n    const d_ep = d_Ep(ph_r, ph_w) // Average void envelope thickness\n    const ep_r = (d_ep > 0) ? 1 - (1 + d_ep / d_r) ** -3 : 1; // Red cell porosity\n    const ep_w = (d_ep > 0) ? 1 - (1 + d_ep / d_w) ** -3 : 1; // White cell porosity\n    const vrs = Sr_g * (rho_r - rho_susp) / (rho_r - rho_f) * ep_r**4.6 // Red cells hindered settling\n    const vws = Sw_g * (rho_w - rho_susp) / (rho_w - rho_f) * ep_w**4.6 // White cells hindered settling\n    const vfc = -(ph_r * vrs + ph_w * vws) // Fluid counterflow\n    const vrc = vrs + vfc // Red cell velocity\n    const vwc = vws + vfc // White cell velocity\n    return { red: vrc, white:  vwc } // mm / s\n}\n\n/**\n * Calculate spatial derivative of 1D y mesh with x differential dx\n * @param y array of scalar values\n * @param dx spacing between y values\n * @returns dydx array\n */\nexport function grad(y: number[], dx: number) {\n    const len = y.length;\n    if (len < 2) return [0];\n\n    // Generate array and set edges\n    const dydx = new Array(len);\n    dydx[0] = (y[1] - y[0]) / dx;\n    dydx[len-1] = (y[len-1] - y[len-2]) / dx;\n\n    // Calc middle derivs with 2nd order accuracy\n    for (let i=1; i<len-1; i++) {\n        const left = y[i-1];\n        const right= y[i+1];\n        dydx[i] = (right - left) / 2 / dx;\n    }\n    \n    return dydx;\n}\n\nexport function rhs_adv_diff(y: number[], dz: number) {\n    // Unpack y\n    const cr = y.slice(0,CONC_ARRAY_SIZE); \n    const cw = y.slice(CONC_ARRAY_SIZE);\n\n    // BCs\n    cr[0] = 0; cw[0] = 0;\n    cr[CONC_ARRAY_SIZE - 1] = cr[CONC_ARRAY_SIZE - 2]; \n    cw[CONC_ARRAY_SIZE - 1] = cw[CONC_ARRAY_SIZE - 2];\n\n    // For advection term\n    const crvr = new Array(CONC_ARRAY_SIZE);\n    const cwvw = new Array(CONC_ARRAY_SIZE);\n    crvr[0] = 0;\n    cwvw[0] = 0;\n    for (let i=1;i<CONC_ARRAY_SIZE;i++) {\n        // Determine velocity\n        const { red, white } = particle_velocities(cr[i], cw[i]);\n        if (red !== red) throw new Error(`bad red at concentration ${cr[i]} ${cw[i]}`)\n        crvr[i] = cr[i] * red;\n        cwvw[i] = cw[i] * white;\n        if (crvr[i] !== crvr[i]) throw new Error(`crvr err: ${crvr}`)\n    }\n    crvr[CONC_ARRAY_SIZE-1] = 0;\n    cwvw[CONC_ARRAY_SIZE-1] = 0;\n\n    // Advection term\n    const adv_r = grad(crvr, dz);\n    const adv_w = grad(cwvw, dz);\n    for (let i=0;i<CONC_ARRAY_SIZE;i++) {\n        if (adv_r !== adv_r) throw new Error(`adv_r error: ${adv_r}`)\n    }\n\n    // For diffusion term\n    const inner_dif_r = new Array(CONC_ARRAY_SIZE);\n    const inner_dif_w = new Array(CONC_ARRAY_SIZE);\n    inner_dif_r[0] = 5 * (cr[1] - cr[0]) / dz * (1 - cr[0] / cr_max)**10;\n    inner_dif_w[0] = 5 * (cw[1] - cw[0]) / dz * (1 - cw[0] / cw_max)**10;\n    for (let i=1;i<CONC_ARRAY_SIZE-1;i++) {\n        const dcri = (cr[i+1] - cr[i-1]) / 2 / dz;\n        const dcwi = (cw[i+1] - cw[i-1]) / 2 / dz;\n        inner_dif_r[i] = 5 * dcri * (1 - cr[i] / cr_max)**10;\n        inner_dif_w[i] = 5 * dcwi * (1 - cw[i] / cw_max)**10;\n        if (inner_dif_r[i] !== inner_dif_r[i]) throw new Error(`inner_dif_r err: ${inner_dif_r}`)\n    }\n    inner_dif_r[CONC_ARRAY_SIZE-1] = 5 * (cr[CONC_ARRAY_SIZE-1] - cr[CONC_ARRAY_SIZE-2]) / dz * (1 - cr[CONC_ARRAY_SIZE-1] / cr_max)**10;\n    inner_dif_w[CONC_ARRAY_SIZE-1] = 5 * (cw[CONC_ARRAY_SIZE-1] - cw[CONC_ARRAY_SIZE-2]) / dz * (1 - cw[CONC_ARRAY_SIZE-1] / cw_max)**10;\n\n    const dif_r = grad(inner_dif_r, dz);\n    const dif_w = grad(inner_dif_w, dz);\n    dif_r[0] = dif_r[CONC_ARRAY_SIZE-1] = 0;\n    dif_w[0] = dif_w[CONC_ARRAY_SIZE-1] = 0;\n\n    // Results \n    const drdt = new Array(CONC_ARRAY_SIZE);\n    const dwdt = new Array(CONC_ARRAY_SIZE);\n    drdt[0] = dwdt[0] = 0;\n    for (let i=1; i<CONC_ARRAY_SIZE-1;i++) {\n        drdt[i] = dif_r[i] - adv_r[i];\n        dwdt[i] = dif_w[i] - adv_w[i];\n    }\n    drdt[CONC_ARRAY_SIZE-1] = -adv_r[CONC_ARRAY_SIZE-1];\n    dwdt[CONC_ARRAY_SIZE-1] = -adv_w[CONC_ARRAY_SIZE-1];\n\n    // console.log(drdt.map((dr,i) => (dr !== dr) ? i : 0).filter(e => e !== 0));\n    // console.log(drdt.slice(490));\n\n    return drdt.concat(dwdt);\n}\n\n/**\n * Convolve a 1D numpy array y with a moving average filter of given size.\n * Pads the edges with the first and last values in y to maintain size.\n * @param y array to smooth\n * @param window_size size of kernel\n * @returns smoothed array of same length as y\n */\nexport function movingAverageConvolve(y: number[], windowSize: number): number[] {\n  if (windowSize < 1) throw new Error(\"windowSize must be at least 1\");\n  if (windowSize === 1) return y;\n\n  const padWidth = Math.floor(windowSize / 2);\n  const n = y.length;\n\n  // Pad edges with the first and last values\n  const padded = [\n    ...Array(padWidth).fill(y[0]),\n    ...y,\n    ...Array(padWidth).fill(y[n - 1])\n  ];\n\n  // Precompute kernel weight\n  const norm = 1 / windowSize;\n\n  const smoothed: number[] = new Array(n);\n\n  // Perform convolution\n  for (let i = 0; i < n; i++) {\n    let sum = 0;\n    for (let j = 0; j < windowSize; j++) {\n      sum += padded[i + j];\n    }\n    smoothed[i] = sum * norm;\n  }\n\n  return smoothed;\n}\n\n/**\n * Linearly interpolate points in x to find corresponding points in y using xp and fp\n * @param x x coordinates of resulting points\n * @param xp x coordinates to interpolate between\n * @param fp values corresponding to original xp array\n * @returns f values corresponding to each x\n */\nexport function interp(x: number | number[], xp: number[], fp: number[]) {\n    if (!Array.isArray(x)) x = [x];\n    const f = x.map(xi => {\n        let nx = xp.length;\n        // Make sure we stay in the bounds\n        if (xi < xp[0]) {\n            console.warn(`interp point ${xi} out of min range for x array with min ${xp[0]}`);\n            return fp[0];\n        }\n\n        // Find the lo and hi indices\n        let lo=0, hi=1;\n        for (let j=0;j<nx;j++) {\n            if (xp[j] <= xi) lo = j;\n            else break;\n        }\n\n        // Interpolate results\n        if (lo === nx-1) {\n            return fp[nx-1];\n        }\n        hi = lo + 1;\n        const fi = fp[lo] + (fp[hi] - fp[lo]) * (xi - xp[lo]) / (xp[hi] - xp[lo]);\n        return fi;\n    });\n\n    return f;\n}\n\n/**\n * \n * @param y \n * @param z \n * @param lo \n * @param hi \n * @returns \n */\nexport function resize(y: number[], z: number[], lo: number) {\n    const cr = y.slice(0, CONC_ARRAY_SIZE);\n    const cw = y.slice(CONC_ARRAY_SIZE);\n\n    if (cr.length !== z.length || cw.length !== z.length) throw new Error(`y and z must have same length\\ncr:${cr.length}\\ncw:${cw.length}\\nz:${z.length}`);\n    const nz = cr.length;\n    const z_hi = z[nz - 1];\n    if (z_hi < 304.99) throw new Error(`z_hi = ${z_hi} which is a significant deviation from l=305 mm`);\n\n    // Determine where to start the new coordinate axis\n    let min_idx: number | undefined = undefined;\n    let sum = 0;\n    for (let i=0;i<cr.length;i++) {\n        const ph = cr[i] + cw[i];\n        sum += ph;\n        if (sum < lo) min_idx = i;\n        else if (sum >= 2*lo) break;\n    }\n    if (min_idx === undefined) return { y, z };\n\n    // Determine the new range and construct the new z array\n    const lz = z_hi - z[min_idx];\n    const z_new = Array.from({ length: nz }, (_,i) => i / (nz-1) * lz + z[min_idx]);\n\n    // Interpolate to get the new f(z) points in the array.\n    const cr_new = interp(z_new, z, cr);\n    const cw_new = interp(z_new, z, cw);\n\n    return { y: cr_new.concat(cw_new), z: z_new };\n}\n\n\nconst nz = CONC_ARRAY_SIZE;\nconst smooth_fsize = 13;\nexport const SOLVER_TIMESTEP = 20;\nexport class ProfileSolver {\n    private current: number[];\n    private top = 0;\n    private t = 0;\n\n    constructor(xr0: number, xw0: number) {\n        // Prepare the initial profile\n        const cr0: number[] = new Array(nz).fill(conc_r(xr0));\n        const cw0: number[] = new Array(nz).fill(conc_w(xw0));\n        cr0[0] = cw0[0] = 0; // Free surface\n        this.current = cr0.concat(cw0);\n    }\n\n    // Spatial helpers\n    private lz = () => { return TUBE_LENGTH - this.top; }\n    private dz = () => { return this.lz() / (nz - 1); }\n    private create_z_arr = () => {\n        const dz = this.dz();\n        return Array.from({ length: nz }, (_,i) => i * dz + this.top);\n    }\n\n    // Rhs wrapper\n    private rhs = (_: number, y: number[]) => {\n        return rhs_adv_diff(y, this.dz());\n    };\n\n    /**\n     * Calculate one 20 second step for the profile\n     * @returns Results at time t + timestep\n     */\n    public calculate_step = () => {\n        const sol = rk45(this.rhs, this.current, 0, SOLVER_TIMESTEP, { rtol: 1e-4, atol: 1e-6 });\n\n        // Extract solution\n        let y_cur = sol.y.at(-1)!;\n        let cr_cur = y_cur.slice(0,nz);\n        let cw_cur = y_cur.slice(nz);\n\n        // Smooth\n        cr_cur = movingAverageConvolve(cr_cur, smooth_fsize);\n        cw_cur = movingAverageConvolve(cw_cur, smooth_fsize);\n        y_cur = cr_cur.concat(cw_cur);\n\n        // Resize\n        const resized = resize(y_cur, this.create_z_arr(), .05);\n        this.current = resized.y;\n        this.top = resized.z[0];\n        this.t += SOLVER_TIMESTEP;\n\n        console.log(\"Solved to t=\", this.t)\n        const returnProf = new Float32Array([this.t, this.top].concat(this.current)) as Profile\n        for (let i=2;i<502;i++) {\n            returnProf[i] = phi_r(returnProf[i]);\n        }\n        for (let i=502;i<1002;i++) {\n            returnProf[i] = phi_w(returnProf[i]);\n        }\n        return returnProf;\n    }\n}\n\n\nexport const createProfile = (initConc: InitConc): Profile => {\n    // Initialize profile\n    const xr0 = initConc.xr0;\n    const xw0 = initConc.xw0;\n    const init: number[] = new Array(PROFILE_LENGTH);\n    init[0] = 0; // time\n    init[1] = 0; // top\n    for (let i=2;i<CONC_ARRAY_SIZE+2;i++) {\n        init[i] = xr0;\n    }\n    for (let i=2+CONC_ARRAY_SIZE;i<2*CONC_ARRAY_SIZE+2;i++) {\n        init[i] = xw0;\n    }\n\n    return new Float32Array(init);\n}","import type { WorkerMessage } from \"./worker-types\";\n\n// Base worker\nexport abstract class BaseWorker {\n    constructor() {\n        self.onmessage = (e) => this.handleMessage(e.data);\n    }\n\n    protected post<T>(msg: WorkerMessage<T>) {\n        (self as any).postMessage(msg);\n    }\n    protected error(reason: string, fatal?: boolean) {\n        const msg = {\n            type: \"error\",\n            payload: {\n                reason: reason,\n                fatal: fatal\n            }\n        };\n        (self as any).postMessage(msg);\n    }\n\n    protected abstract handleMessage(msg: WorkerMessage): void;\n}\n","import { ProfileSolver } from \"../calcs\";\nimport { BaseWorker } from \"./baseWorker\";\nimport type { DataMessage, InitMessage, WorkerMessage } from \"./worker-types\";\n\nconst printProducer = (str: string) => console.log(\"%c[Producer] \" + `%c${str}`, \"color: red\", \"color: white\");\n\ntry {\n/**\n * Producer class. On request, iterates its solver and sends the resulting data.\n */\nclass ProducerWorker extends BaseWorker {\n    private solver: ProfileSolver | undefined = undefined;\n\n    protected handleMessage(msg: WorkerMessage): void {\n        if (msg.type === \"init\") {\n            msg = msg as InitMessage;\n            const payload = msg.payload;\n            if (!payload) {\n                this.error(\"no initializer payload\");\n            }\n            const { xr0, xw0 } = payload.initConditions ?? { xr0: 0.05, xw0: 0.05 };\n            this.solver = new ProfileSolver(xr0, xw0);\n            return;\n        }\n\n        if (msg.type === \"produce\") {\n            printProducer(\"Recieved produce message\")\n            this.produce();\n            return;\n        }\n    }\n\n    private produce = () => {\n        if (!this.solver) {\n            this.error(\"uninitialized solver or buffer\");\n            return;\n        }\n\n        // Always generate data when available\n        const sol = this.solver.calculate_step();\n        const msg: DataMessage = { type: \"data\", payload: sol };\n        this.post(msg);\n    }\n}\n\nnew ProducerWorker();\n\n}\ncatch (e) {\n    self.postMessage({ type: \"fatal\", payload: e });\n}"],"names":["rk45","f","y0","t0","tEnd","opts","dt","atol","rtol","dtMin","dtMax","safety","c2","c3","c4","c5","c6","a21","a31","a32","a41","a42","a43","a51","a52","a53","a54","a61","a62","a63","a64","a65","b1","b3","b4","b5","b6","b1s","b3s","b4s","b5s","t","y","h","tVals","yVals","k1","k2","yi","i","k3","k4","k5","k6","y4","y5","err","_","a","b","scale","rho_f","g","mu","rho_r","d_r","rho_w","d_w","TUBE_LENGTH","CONC_ARRAY_SIZE","concentration","phi","dp","conc_r","conc_w","cr_max","cw_max","volume_fraction","conc","phi_r","phi_w","settling_coeff_g","d_p","rho_p","d_Ep","r_conc","w_conc","d_avg","ep","pow","Sr_g","Sw_g","particle_velocities","ph_r","ph_w","conc_f","rho_susp","d_ep","ep_r","ep_w","vrs","vws","vfc","vrc","vwc","grad","dx","len","dydx","left","right","rhs_adv_diff","dz","cr","cw","crvr","cwvw","red","white","adv_r","adv_w","inner_dif_r","inner_dif_w","dcri","dcwi","dif_r","dif_w","drdt","dwdt","movingAverageConvolve","windowSize","padWidth","padded","norm","smoothed","sum","j","interp","x","xp","fp","xi","nx","lo","hi","resize","z","nz","z_hi","min_idx","ph","lz","z_new","cr_new","cw_new","smooth_fsize","SOLVER_TIMESTEP","ProfileSolver","xr0","xw0","cr0","cw0","y_cur","cr_cur","cw_cur","resized","returnProf","BaseWorker","e","msg","reason","fatal","printProducer","str","ProducerWorker","payload"],"mappings":"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"}