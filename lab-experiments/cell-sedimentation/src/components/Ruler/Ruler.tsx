import { createSignal, onMount, type Accessor, type Component } from "solid-js";
import "./Ruler.css";

type RulerProps = {
    showing: Accessor<boolean>;
};

export const Ruler: Component<RulerProps> = ({ showing }) => {
    const [coords, setCoords] = createSignal({ top: 0, left: 0, scale: 1 });

    const reposition = () => {
        const cnv = document.getElementById("main-cnv")!;
        const bds = cnv.getBoundingClientRect();
        const top = bds.height * .055;
        const left = bds.width * .5 + bds.height * .325;
        const scale = bds.height / 850;
        setCoords({ top, left, scale });
        console.log("new top:", top)
    }

    onMount(() => {
        window.addEventListener("resize", reposition);
        reposition();
    });

    return (<>
<svg class="ruler-cnv" width="169" height="818" style={{"top": `${coords().top}px`, "left": `${coords().left}`, "transform": `translate(-50%, -50%) scale(${coords().scale}) translate(0, 50%)`}} viewBox="0 0 169 818" fill="none" xmlns="http://www.w3.org/2000/svg">
    <g class="ruler" opacity={showing() ? 1 : 0}>
        <line x1="15.5" y1="764" x2="15.5" y2="769" stroke="black" stroke-width="3"/>
        <path d="M2.26705 800L9.88636 784.932V784.804H1.07386V782.545H12.6136V784.881L5.01989 800H2.26705ZM21.9631 800V786.909H24.4091V789.04H24.571C24.8438 788.318 25.2898 787.756 25.9091 787.352C26.5284 786.943 27.2699 786.739 28.1335 786.739C29.0085 786.739 29.7415 786.943 30.3324 787.352C30.929 787.761 31.3693 788.324 31.6534 789.04H31.7898C32.1023 788.341 32.5994 787.784 33.2812 787.369C33.9631 786.949 34.7756 786.739 35.7188 786.739C36.9062 786.739 37.875 787.111 38.625 787.855C39.3807 788.599 39.7585 789.722 39.7585 791.222V800H37.2102V791.46C37.2102 790.574 36.9688 789.932 36.4858 789.534C36.0028 789.136 35.4261 788.938 34.7557 788.938C33.9261 788.938 33.2812 789.193 32.821 789.705C32.3608 790.21 32.1307 790.861 32.1307 791.656V800H29.5909V791.298C29.5909 790.588 29.3693 790.017 28.9261 789.585C28.483 789.153 27.9063 788.938 27.196 788.938C26.7131 788.938 26.267 789.065 25.858 789.321C25.4545 789.571 25.1278 789.92 24.8778 790.369C24.6335 790.818 24.5114 791.338 24.5114 791.929V800H21.9631ZM43.174 800V786.909H45.62V789.04H45.782C46.0547 788.318 46.5007 787.756 47.12 787.352C47.7393 786.943 48.4808 786.739 49.3445 786.739C50.2195 786.739 50.9524 786.943 51.5433 787.352C52.1399 787.761 52.5803 788.324 52.8643 789.04H53.0007C53.3132 788.341 53.8104 787.784 54.4922 787.369C55.174 786.949 55.9865 786.739 56.9297 786.739C58.1172 786.739 59.0859 787.111 59.8359 787.855C60.5916 788.599 60.9695 789.722 60.9695 791.222V800H58.4212V791.46C58.4212 790.574 58.1797 789.932 57.6967 789.534C57.2138 789.136 56.6371 788.938 55.9666 788.938C55.1371 788.938 54.4922 789.193 54.032 789.705C53.5717 790.21 53.3416 790.861 53.3416 791.656V800H50.8018V791.298C50.8018 790.588 50.5803 790.017 50.1371 789.585C49.6939 789.153 49.1172 788.938 48.407 788.938C47.924 788.938 47.478 789.065 47.0689 789.321C46.6655 789.571 46.3388 789.92 46.0888 790.369C45.8445 790.818 45.7223 791.338 45.7223 791.929V800H43.174Z" fill="black"/>
        <line x1="14" y1="771" x2="37" y2="771" stroke="black" stroke-width="4"/>
        <line x1="35.5" y1="764" x2="35.5" y2="769" stroke="black" stroke-width="3"/>
        <path d="M77.7557 358.239C76.5852 358.239 75.5398 358.037 74.6193 357.634C73.7045 357.23 72.9801 356.67 72.446 355.955C71.9176 355.233 71.6335 354.398 71.5938 353.449H74.2699C74.304 353.966 74.4773 354.415 74.7898 354.795C75.108 355.17 75.5227 355.46 76.0341 355.665C76.5455 355.869 77.1136 355.972 77.7386 355.972C78.4261 355.972 79.0341 355.852 79.5625 355.614C80.0966 355.375 80.5142 355.043 80.8153 354.616C81.1165 354.185 81.267 353.688 81.267 353.125C81.267 352.54 81.1165 352.026 80.8153 351.582C80.5199 351.134 80.0852 350.781 79.5114 350.526C78.9432 350.27 78.2557 350.142 77.4489 350.142H75.9744V347.994H77.4489C78.0966 347.994 78.6648 347.878 79.1534 347.645C79.6477 347.412 80.0341 347.088 80.3125 346.673C80.5909 346.253 80.7301 345.761 80.7301 345.199C80.7301 344.659 80.608 344.19 80.3636 343.793C80.125 343.389 79.7841 343.074 79.3409 342.847C78.9034 342.619 78.3864 342.506 77.7898 342.506C77.2216 342.506 76.6903 342.611 76.196 342.821C75.7074 343.026 75.3097 343.321 75.0028 343.707C74.696 344.088 74.5313 344.545 74.5085 345.08H71.9602C71.9886 344.136 72.267 343.307 72.7955 342.591C73.3295 341.875 74.0341 341.315 74.9091 340.912C75.7841 340.509 76.7557 340.307 77.8239 340.307C78.9432 340.307 79.9091 340.526 80.7216 340.963C81.5398 341.395 82.1705 341.972 82.6136 342.693C83.0625 343.415 83.2841 344.205 83.2784 345.062C83.2841 346.04 83.0114 346.869 82.4602 347.551C81.9148 348.233 81.1875 348.69 80.2784 348.923V349.06C81.4375 349.236 82.3352 349.696 82.9716 350.44C83.6136 351.185 83.9318 352.108 83.9261 353.21C83.9318 354.17 83.6648 355.031 83.125 355.793C82.5909 356.554 81.8608 357.153 80.9347 357.591C80.0085 358.023 78.9489 358.239 77.7557 358.239ZM93.2244 358.29C91.8778 358.284 90.7273 357.929 89.7727 357.224C88.8182 356.52 88.0881 355.494 87.5824 354.148C87.0767 352.801 86.8239 351.179 86.8239 349.281C86.8239 347.389 87.0767 345.773 87.5824 344.432C88.0938 343.091 88.8267 342.068 89.7812 341.364C90.7415 340.659 91.8892 340.307 93.2244 340.307C94.5597 340.307 95.7045 340.662 96.6591 341.372C97.6136 342.077 98.3438 343.099 98.8494 344.44C99.3608 345.776 99.6165 347.389 99.6165 349.281C99.6165 351.185 99.3636 352.81 98.858 354.156C98.3523 355.497 97.6222 356.523 96.6676 357.233C95.7131 357.938 94.5653 358.29 93.2244 358.29ZM93.2244 356.014C94.4063 356.014 95.3295 355.438 95.9943 354.284C96.6648 353.131 97 351.463 97 349.281C97 347.832 96.8466 346.608 96.5398 345.608C96.2386 344.602 95.804 343.841 95.2358 343.324C94.6733 342.801 94.0028 342.54 93.2244 342.54C92.0483 342.54 91.125 343.119 90.4545 344.278C89.7841 345.437 89.446 347.105 89.4403 349.281C89.4403 350.736 89.5909 351.966 89.892 352.972C90.1989 353.972 90.6335 354.73 91.196 355.247C91.7585 355.759 92.4347 356.014 93.2244 356.014ZM108.401 358.239C107.333 358.239 106.373 358.034 105.521 357.625C104.674 357.21 103.998 356.642 103.492 355.92C102.987 355.199 102.717 354.375 102.683 353.449H105.239C105.302 354.199 105.634 354.815 106.237 355.298C106.839 355.781 107.56 356.023 108.401 356.023C109.072 356.023 109.665 355.869 110.183 355.562C110.705 355.25 111.114 354.821 111.41 354.276C111.711 353.73 111.862 353.108 111.862 352.409C111.862 351.699 111.708 351.065 111.401 350.509C111.094 349.952 110.671 349.514 110.131 349.196C109.597 348.878 108.984 348.716 108.29 348.71C107.762 348.71 107.231 348.801 106.697 348.983C106.163 349.165 105.731 349.403 105.401 349.699L102.989 349.341L103.969 340.545H113.566V342.804H106.16L105.606 347.688H105.708C106.049 347.358 106.501 347.082 107.063 346.861C107.631 346.639 108.239 346.528 108.887 346.528C109.95 346.528 110.896 346.781 111.725 347.287C112.56 347.793 113.217 348.483 113.694 349.358C114.177 350.227 114.415 351.227 114.41 352.358C114.415 353.489 114.16 354.497 113.643 355.384C113.131 356.27 112.421 356.969 111.512 357.48C110.609 357.986 109.572 358.239 108.401 358.239ZM123.908 358V344.909H126.354V347.04H126.516C126.789 346.318 127.235 345.756 127.854 345.352C128.474 344.943 129.215 344.739 130.079 344.739C130.954 344.739 131.687 344.943 132.278 345.352C132.874 345.761 133.315 346.324 133.599 347.04H133.735C134.048 346.341 134.545 345.784 135.227 345.369C135.908 344.949 136.721 344.739 137.664 344.739C138.852 344.739 139.82 345.111 140.57 345.855C141.326 346.599 141.704 347.722 141.704 349.222V358H139.156V349.46C139.156 348.574 138.914 347.932 138.431 347.534C137.948 347.136 137.371 346.938 136.701 346.938C135.871 346.938 135.227 347.193 134.766 347.705C134.306 348.21 134.076 348.861 134.076 349.656V358H131.536V349.298C131.536 348.588 131.315 348.017 130.871 347.585C130.428 347.153 129.852 346.938 129.141 346.938C128.658 346.938 128.212 347.065 127.803 347.321C127.4 347.571 127.073 347.92 126.823 348.369C126.579 348.818 126.457 349.338 126.457 349.929V358H123.908ZM145.119 358V344.909H147.565V347.04H147.727C148 346.318 148.446 345.756 149.065 345.352C149.685 344.943 150.426 344.739 151.29 344.739C152.165 344.739 152.898 344.943 153.489 345.352C154.085 345.761 154.526 346.324 154.81 347.04H154.946C155.259 346.341 155.756 345.784 156.438 345.369C157.119 344.949 157.932 344.739 158.875 344.739C160.062 344.739 161.031 345.111 161.781 345.855C162.537 346.599 162.915 347.722 162.915 349.222V358H160.366V349.46C160.366 348.574 160.125 347.932 159.642 347.534C159.159 347.136 158.582 346.938 157.912 346.938C157.082 346.938 156.438 347.193 155.977 347.705C155.517 348.21 155.287 348.861 155.287 349.656V358H152.747V349.298C152.747 348.588 152.526 348.017 152.082 347.585C151.639 347.153 151.063 346.938 150.352 346.938C149.869 346.938 149.423 347.065 149.014 347.321C148.611 347.571 148.284 347.92 148.034 348.369C147.79 348.818 147.668 349.338 147.668 349.929V358H145.119Z" fill="black"/>
        <line x1="60" y1="4" x2="60" y2="748" stroke="black" stroke-width="6"/>
        <line x1="45" y1="2" x2="63" y2="2" stroke="black" stroke-width="4"/>
        <line x1="45" y1="750" x2="63" y2="750" stroke="black" stroke-width="4"/>
    </g>
</svg>
    </>)
}

